# agents.md

Этот файл содержит инструкции для Claude Code (claude.ai/code) при работе с этим репозиторием.

## Обзор проекта

Этот репозиторий управляет прошивкой ZMK для разделенной клавиатуры Corne с поддержкой Bluetooth, используя контроллеры NRF 52840 (совместимые с nice nano). Настройка включает поддержку русской раскладки клавиатуры и интеграцию с онлайн-редактором раскладок.

## Конфигурация оборудования

- **Клавиатура**: Corne split keyboard (42 клавиши)
- **Контроллеры**: Pro Micro NRF 52840 (совместимые с nice nano)
- **Подключение**: Bluetooth
- **Платформа**: macOS

## Структура директорий

- `/clear_firmware` - Прошивка сброса (zmk.hex, zmk.uf2), используется для очистки клавиатуры перед прошивкой новой прошивки
- `/factory_firmware` - Работающая заводская прошивка для клавиатуры jorne (левая/правая половинки)
- `/firmware` - Пользовательские скомпилированные версии прошивки для клавиатуры corne (левая/правая половинки)
- `keys_ru.h` - Заголовок с русской раскладкой, содержащий коды ZMK HID, отображающие кириллические символы на позиции QWERTY
- `/docs` - Инструкции по настройке и руководства по устранению неполадок (на русском языке)

## Процесс прошивки

Процесс прошивки следует этим шагам:

1. **Забыть устройство** - Удалить клавиатуру из параметров Bluetooth на macOS
2. **Очистить прошивку** - Подключить половинку через USB, дважды нажать кнопку сброса (красный светодиод мигает), скопировать оба файла zmk.hex и zmk.uf2 на устройство, повторить для другой половинки
3. **Залить прошивку** - Подключить половинку через USB, дважды нажать сброс, скопировать файл .uf2 для этой половинки (сначала правая, потом левая)
4. **Сброс** - Однократно нажать кнопку сброса на обоих половинках
5. **Переподключиться** - Подключить к macOS через Bluetooth

Примечание: Ошибки отключения диска во время прошивки - нормальное поведение.

## Конфигурация раскладки

Раскладки настраиваются с использованием веб-редактора раскладок на https://nickcoutsos.github.io/keymap-editor/, который подключается к репозиториям GitHub.

**Текущие репозитории:**
- Основной: https://github.com/ladkin/zmk-config-corne
- Резервный: https://github.com/ladkin/zmk-config

При изменении раскладок:
- Изменения сохраняются в выбранном репозитории/ветке GitHub
- GitHub Actions автоматически собирает прошивку
- Скачать созданные файлы .uf2 и залить их, используя процесс выше


## Известные проблемы

- Первый репозиторий успешно собирается, но клавиатура не появляется в устройствах Bluetooth после прошивки
- Второй репозиторий имеет ошибки сборки в GitHub Actions
- Оба репозитория имеют правильную настройку GitHub Actions и разрешения

## Полезные ресурсы

- https://typus.ru/firmware_builds - Сборки прошивок
- https://typus.ru/zmk - Информация о ZMK
- https://key-test.ru/ - Инструмент тестирования клавиатуры
- https://github.com/aroum/Watchman-layouts - Примеры раскладок
